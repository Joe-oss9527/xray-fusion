#!/usr/bin/env bash
set -euo pipefail
SCRIPT_PATH="$(readlink -f "${BASH_SOURCE[0]}")"
HERE="$(cd "$(dirname "${SCRIPT_PATH}")/.." && pwd)"
. "${HERE}/lib/core.sh"
usage() {
  cat << EOF
xrf â€” Xray Fusion Lite (complete clean)
Usage: xrf <command>
  install     Install Xray & deploy confdir (atomic, flock-protected)
  status      Show version & active confdir
  uninstall   Remove Xray (keep state)
  links       Print client links
  plugin      Manage plugins (list/enable/disable/info)
  help        Show this help
EOF
}
case "${1-}" in
  install)
    shift || true
    "${HERE}/commands/install.sh" "$@"
    ;;
  status)
    shift || true
    "${HERE}/commands/status.sh" "$@"
    ;;
  uninstall)
    shift || true
    "${HERE}/commands/uninstall.sh" "$@"
    ;;
  links)
    shift || true
    "${HERE}/services/xray/client-links.sh" "$@"
    ;;
  plugin)
    shift || true
    "${HERE}/commands/plugin.sh" "$@"
    ;;
  help | "") usage ;;
  *)
    usage
    exit 2
    ;;
esac
